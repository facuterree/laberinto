<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Laberinto de Alicia</title>
<style>
  body {
    margin: 0;
    background-color: #000;
    font-family: sans-serif;
    overflow: hidden;
  }

  #game {
    position: relative;
    width: 800px;
    height: 800px;
    margin: 20px auto;
    background: url('https://i.imgur.com/tD3pU1F.jpg') no-repeat center center/cover;
    border: 3px solid #fff;
    box-shadow: 0 0 20px #0ff;
  }

  .wall {
    position: absolute;
    background-color: rgba(50,50,50,0.8);
    border: 2px solid #555;
  }

  .potion {
    position: absolute;
    width: 30px;
    height: 30px;
    font-size: 24px;
    text-align: center;
    line-height: 30px;
    cursor: pointer;
  }

  #player {
    position: absolute;
    width: 40px;
    height: 40px;
    font-size: 32px;
    text-align: center;
    line-height: 40px;
    transition: transform 0.3s, filter 0.3s;
  }

  #exit {
    position: absolute;
    width: 50px;
    height: 50px;
    font-size: 48px;
    text-align: center;
    line-height: 50px;
  }

  #hud {
    color: #fff;
    font-size: 20px;
    text-align: center;
    margin-bottom: 10px;
  }

  #message {
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    color: #fff;
    font-size: 32px;
    text-align: center;
    display: none;
    background: rgba(0,0,0,0.8);
    padding: 20px;
    border-radius: 15px;
  }

  #restart {
    display: none;
    position: absolute;
    top: 65%;
    left: 50%;
    transform: translate(-50%, -50%);
    background-color: #222;
    color: #fff;
    border: 2px solid #fff;
    padding: 10px 20px;
    font-size: 20px;
    border-radius: 10px;
    cursor: pointer;
  }

  #restart:hover {
    background-color: #444;
  }
</style>
</head>
<body>
<div id="hud">‚è∞ Tiempo: <span id="timer">60</span>s</div>
<div id="game">
  <div id="player">üëß</div>
  <div id="exit">üö™</div>
  <div class="potion" style="left:150px; top:150px;">üíß</div>
  <div class="potion" style="left:600px; top:100px;">üíß</div>
  <div class="potion" style="left:300px; top:600px;">üíß</div>
  <div class="potion" style="left:700px; top:700px;">üíß</div>

  <!-- Paredes externas -->
  <div class="wall" style="left:0; top:0; width:800px; height:20px;"></div>
  <div class="wall" style="left:0; top:0; width:20px; height:800px;"></div>
  <div class="wall" style="left:0; bottom:0; width:800px; height:20px;"></div>
  <div class="wall" style="right:0; top:0; width:20px; height:800px;"></div>

  <!-- Pasillos internos -->
  <div class="wall" style="left:100px; top:100px; width:600px; height:20px;"></div>
  <div class="wall" style="left:100px; top:100px; width:20px; height:600px;"></div>
  <div class="wall" style="left:680px; top:100px; width:20px; height:600px;"></div>
  <div class="wall" style="left:100px; top:680px; width:600px; height:20px;"></div>
  <div class="wall" style="left:300px; top:200px; width:20px; height:400px;"></div>
  <div class="wall" style="left:500px; top:200px; width:20px; height:400px;"></div>
</div>

<div id="message"></div>
<button id="restart">üîÅ Reiniciar</button>

<script>
const player = document.getElementById('player');
const exit = document.getElementById('exit');
const potions = document.querySelectorAll('.potion');
const walls = document.querySelectorAll('.wall');
const timerEl = document.getElementById('timer');
const message = document.getElementById('message');
const restartBtn = document.getElementById('restart');

let posX = 50, posY = 50;
let baseSpeed = 10;
let size = 1;
let timeLeft = 60;
let gameOver = false;

player.style.left = posX + 'px';
player.style.top = posY + 'px';
exit.style.left = '720px';
exit.style.top = '720px';

function checkCollision(x, y) {
  const playerRect = {left:x, top:y, right:x+40*size, bottom:y+40*size};
  for(const wall of walls){
    const wallRect = {
      left: wall.offsetLeft,
      top: wall.offsetTop,
      right: wall.offsetLeft + wall.offsetWidth,
      bottom: wall.offsetTop + wall.offsetHeight
    };
    if(playerRect.left < wallRect.right && playerRect.right > wallRect.left && playerRect.top < wallRect.bottom && playerRect.bottom > wallRect.top){
      return true;
    }
  }
  return false;
}

document.addEventListener('keydown', e => {
  if(gameOver) return;
  let nextX = posX;
  let nextY = posY;
  let currentSpeed = baseSpeed / size; // m√°s grande ‚Üí m√°s lento
  if(e.key==='ArrowUp'||e.key==='w') nextY-=currentSpeed;
  if(e.key==='ArrowDown'||e.key==='s') nextY+=currentSpeed;
  if(e.key==='ArrowLeft'||e.key==='a') nextX-=currentSpeed;
  if(e.key==='ArrowRight'||e.key==='d') nextX+=currentSpeed;
  if(!checkCollision(nextX,nextY)){
    posX=nextX; posY=nextY;
    player.style.left=posX+'px';
    player.style.top=posY+'px';
    checkPotion();
    checkExit();
  }
});

function checkPotion(){
  const pRect = player.getBoundingClientRect();
  potions.forEach(p=>{
    const rect = p.getBoundingClientRect();
    if(p.style.display!=='none' && 
       pRect.x < rect.x + rect.width && 
       pRect.x + pRect.width > rect.x && 
       pRect.y < rect.y + rect.height && 
       pRect.y + pRect.height > rect.y){
      p.style.display='none';
      size = 1; 
      player.style.transform='scale(1)';
      player.style.filter = 'brightness(2)';
      setTimeout(()=>player.style.filter='brightness(1)', 300);
      timeLeft += 10; 
      timerEl.textContent = timeLeft;
    }
  });
}

function checkExit(){
  const pRect = player.getBoundingClientRect();
  const eRect = exit.getBoundingClientRect();
  if(pRect.x < eRect.x + eRect.width && 
     pRect.x + pRect.width > eRect.x && 
     pRect.y < eRect.y + eRect.height && 
     pRect.y + pRect.height > eRect.y){
    endGame('üéâ ¬°Felicidades, lograste que Alicia salga del laberinto!');
  }
}

function endGame(text){
  gameOver = true;
  message.textContent = text;
  message.style.display = 'block';
  restartBtn.style.display = 'block';
}

restartBtn.addEventListener('click', ()=>location.reload());

const growthInterval = setInterval(()=>{
  if(gameOver) return;
  size += 0.05;
  player.style.transform = 'scale('+size+')';
  if(size >= 2){
    endGame('üò¢ Alicia creci√≥ demasiado y qued√≥ atrapada');
  }
}, 4000);

const timerInterval = setInterval(()=>{
  if(gameOver) return;
  timeLeft--;
  timerEl.textContent = timeLeft;
  if(timeLeft <= 0){
    endGame('‚è∞ Se acab√≥ el tiempo, Alicia qued√≥ atrapada');
  }
}, 1000);
</script>
</body>
</html>
