<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Laberinto de Alicia</title>
<style>
  body {
    margin: 0;
    background-color: #000;
    font-family: "Trebuchet MS", sans-serif;
    overflow: hidden;
  }

  #hud {
    color: #fff;
    font-size: 20px;
    text-align: center;
    margin-top: 10px;
  }

  #game {
    position: relative;
    width: 900px;
    height: 900px;
    margin: 20px auto;
    background: url('https://i.imgur.com/qyjZs5U.jpeg') no-repeat center center/cover;
    border: 3px solid #fff;
    box-shadow: 0 0 25px #0ff;
    overflow: hidden;
  }

  .wall {
    position: absolute;
    background-color: rgba(40,40,40,0.8);
    border: 1px solid #777;
  }

  .potion {
    position: absolute;
    width: 30px;
    height: 30px;
    font-size: 24px;
    text-align: center;
    line-height: 30px;
  }

  #player {
    position: absolute;
    width: 40px;
    height: 40px;
    font-size: 32px;
    text-align: center;
    line-height: 40px;
    transition: transform 0.3s, filter 0.3s;
  }

  #exit {
    position: absolute;
    width: 50px;
    height: 50px;
    font-size: 48px;
    text-align: center;
    line-height: 50px;
  }

  #message {
    position: absolute;
    top: 45%;
    left: 50%;
    transform: translate(-50%, -50%);
    color: #fff;
    font-size: 32px;
    text-align: center;
    display: none;
    background: rgba(0,0,0,0.85);
    padding: 20px;
    border-radius: 15px;
  }

  #restart {
    display: none;
    position: absolute;
    top: 63%;
    left: 50%;
    transform: translate(-50%, -50%);
    background-color: #222;
    color: #fff;
    border: 2px solid #fff;
    padding: 10px 20px;
    font-size: 20px;
    border-radius: 10px;
    cursor: pointer;
  }

  #restart:hover {
    background-color: #444;
  }
</style>
</head>
<body>
<div id="hud">‚è∞ Tiempo: <span id="timer">60</span>s | Nivel: <span id="level">1</span>/4</div>
<div id="game"></div>
<div id="message"></div>
<button id="restart">üîÅ Reiniciar</button>

<script>
const game = document.getElementById('game');
const timerEl = document.getElementById('timer');
const message = document.getElementById('message');
const restartBtn = document.getElementById('restart');
const levelEl = document.getElementById('level');

let posX, posY, player, exit, walls = [], potions = [];
let baseSpeed = 10;
let size = 1;
let timeLeft = 60;
let level = 1;
let gameOver = false;

const levelConfigs = [
  { // Nivel 1: b√°sico y grande
    width: 900, height: 900, exit:{x:800,y:800},
    walls:[
      {x:0,y:0,w:900,h:20},{x:0,y:0,w:20,h:900},{x:0,y:880,w:900,h:20},{x:880,y:0,w:20,h:900},
      {x:100,y:100,w:700,h:20},{x:100,y:100,w:20,h:700},{x:780,y:100,w:20,h:700},{x:100,y:780,w:700,h:20},
      {x:250,y:200,w:20,h:500},{x:450,y:200,w:20,h:500},{x:650,y:200,w:20,h:500}
    ],
    potions:[
      {x:150,y:150},{x:250,y:250},{x:400,y:150},{x:600,y:300},{x:700,y:700},{x:500,y:500},{x:800,y:200}
    ]
  },
  { // Nivel 2
    width: 900, height: 900, exit:{x:820,y:820},
    walls:[
      {x:0,y:0,w:900,h:20},{x:0,y:0,w:20,h:900},{x:0,y:880,w:900,h:20},{x:880,y:0,w:20,h:900},
      {x:100,y:100,w:700,h:20},{x:100,y:100,w:20,h:700},{x:780,y:100,w:20,h:700},{x:100,y:780,w:700,h:20},
      {x:300,y:200,w:20,h:500},{x:500,y:300,w:20,h:400},{x:200,y:400,w:600,h:20}
    ],
    potions:[
      {x:150,y:150},{x:350,y:250},{x:550,y:450},{x:650,y:650},{x:700,y:300},{x:250,y:600}
    ]
  },
  { // Nivel 3
    width: 900, height: 900, exit:{x:820,y:820},
    walls:[
      {x:0,y:0,w:900,h:20},{x:0,y:0,w:20,h:900},{x:0,y:880,w:900,h:20},{x:880,y:0,w:20,h:900},
      {x:150,y:150,w:600,h:20},{x:150,y:150,w:20,h:600},{x:750,y:150,w:20,h:600},{x:150,y:750,w:600,h:20},
      {x:350,y:200,w:20,h:500},{x:550,y:200,w:20,h:500},{x:250,y:400,w:400,h:20}
    ],
    potions:[
      {x:200,y:200},{x:300,y:300},{x:400,y:500},{x:600,y:250},{x:700,y:700},{x:500,y:700}
    ]
  },
  { // Nivel 4 (final, m√°s largo)
    width: 900, height: 900, exit:{x:820,y:820},
    walls:[
      {x:0,y:0,w:900,h:20},{x:0,y:0,w:20,h:900},{x:0,y:880,w:900,h:20},{x:880,y:0,w:20,h:900},
      {x:100,y:100,w:700,h:20},{x:100,y:100,w:20,h:700},{x:780,y:100,w:20,h:700},{x:100,y:780,w:700,h:20},
      {x:200,y:200,w:20,h:500},{x:400,y:200,w:20,h:500},{x:600,y:200,w:20,h:500},
      {x:200,y:400,w:400,h:20},{x:300,y:600,w:400,h:20}
    ],
    potions:[
      {x:150,y:150},{x:350,y:250},{x:550,y:350},{x:700,y:500},{x:400,y:650},{x:200,y:700},{x:650,y:200}
    ]
  }
];

// Inicializar juego
function startLevel(n) {
  game.innerHTML = '';
  walls = [];
  potions = [];
  gameOver = false;
  size = 1;
  timeLeft = 60;
  timerEl.textContent = timeLeft;
  levelEl.textContent = n;
  const config = levelConfigs[n-1];

  // Crear paredes
  config.walls.forEach(w=>{
    const wall = document.createElement('div');
    wall.className = 'wall';
    wall.style.left = w.x+'px';
    wall.style.top = w.y+'px';
    wall.style.width = w.w+'px';
    wall.style.height = w.h+'px';
    game.appendChild(wall);
    walls.push(wall);
  });

  // Crear pociones
  config.potions.forEach(p=>{
    const pot = document.createElement('div');
    pot.className = 'potion';
    pot.textContent = 'üíß';
    pot.style.left = p.x+'px';
    pot.style.top = p.y+'px';
    game.appendChild(pot);
    potions.push(pot);
  });

  // Jugador y salida
  player = document.createElement('div');
  player.id = 'player';
  player.textContent = 'üëß';
  game.appendChild(player);
  posX = 40; posY = 40;
  player.style.left = posX+'px';
  player.style.top = posY+'px';

  exit = document.createElement('div');
  exit.id = 'exit';
  exit.textContent = 'üö™';
  exit.style.left = config.exit.x+'px';
  exit.style.top = config.exit.y+'px';
  game.appendChild(exit);
}

function checkCollision(x,y){
  const playerRect = {left:x,top:y,right:x+40*size,bottom:y+40*size};
  for(const wall of walls){
    const wallRect = {left:wall.offsetLeft,top:wall.offsetTop,right:wall.offsetLeft+wall.offsetWidth,bottom:wall.offsetTop+wall.offsetHeight};
    if(playerRect.left < wallRect.right && playerRect.right > wallRect.left && playerRect.top < wallRect.bottom && playerRect.bottom > wallRect.top){
      return true;
    }
  }
  return false;
}

document.addEventListener('keydown', e=>{
  if(gameOver) return;
  let nextX = posX;
  let nextY = posY;
  let currentSpeed = baseSpeed / size;
  if(e.key==='ArrowUp'||e.key==='w') nextY-=currentSpeed;
  if(e.key==='ArrowDown'||e.key==='s') nextY+=currentSpeed;
  if(e.key==='ArrowLeft'||e.key==='a') nextX-=currentSpeed;
  if(e.key==='ArrowRight'||e.key==='d') nextX+=currentSpeed;
  if(!checkCollision(nextX,nextY)){
    posX=nextX; posY=nextY;
    player.style.left=posX+'px';
    player.style.top=posY+'px';
    checkPotion();
    checkExit();
  }
});

function checkPotion(){
  const pRect = player.getBoundingClientRect();
  potions.forEach(p=>{
    const rect = p.getBoundingClientRect();
    if(p.style.display!=='none' && 
       pRect.x < rect.x + rect.width && 
       pRect.x + pRect.width > rect.x && 
       pRect.y < rect.y + rect.height && 
       pRect.y + pRect.height > rect.y){
      p.style.display='none';
      size=1; player.style.transform='scale(1)';
      player.style.filter='brightness(2)';
      setTimeout(()=>player.style.filter='brightness(1)',300);
      timeLeft+=10;
      timerEl.textContent=timeLeft;
    }
  });
}

function checkExit(){
  const pRect = player.getBoundingClientRect();
  const eRect = exit.getBoundingClientRect();
  if(pRect.x < eRect.x + eRect.width &&
     pRect.x + pRect.width > eRect.x &&
     pRect.y < eRect.y + eRect.height &&
     pRect.y + pRect.height > eRect.y){
    if(level < 4){
      message.textContent = '‚úÖ ¬°Nivel superado!';
      message.style.display = 'block';
      setTimeout(()=>{
        message.style.display='none';
        level++;
        startLevel(level);
      },2000);
    } else {
      endGame('üéâ ¬°Ganaste todos los niveles! Alicia escap√≥ del laberinto.');
    }
  }
}

function endGame(text){
  gameOver = true;
  message.textContent = text;
  message.style.display = 'block';
  restartBtn.style.display = 'block';
}

restartBtn.addEventListener('click', ()=>location.reload());

// Alicia crece cada 15 segundos
setInterval(()=>{
  if(gameOver) return;
  size += 0.1;
  player.style.transform='scale('+size+')';
  if(size>=2){
    endGame('üò¢ Alicia creci√≥ demasiado y qued√≥ atrapada');
  }
},15000);

// Temporizador
setInterval(()=>{
  if(gameOver) return;
  timeLeft--;
  timerEl.textContent = timeLeft;
  if(timeLeft<=0){
    endGame('‚è∞ Se acab√≥ el tiempo, Alicia qued√≥ atrapada');
  }
},1000);

// Iniciar primer nivel
startLevel(level);
</script>
</body>
</html>
